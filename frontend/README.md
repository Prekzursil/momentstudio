# Frontend

Angular 21 storefront/admin UI.

## Requirements

- Node.js (CI uses Node 24 + npm 11.7)
- Chrome/Chromium for unit tests and Playwright E2E

## Configuration

Runtime config is generated by `scripts/generate-config.mjs` into `src/assets/app-config.js`.
It reads from:

- env vars (preferred in CI/containers), or
- `frontend/.env`, `frontend/.env.local`, `frontend/.env.example` (first existing)

## Quick start

```bash
npm ci
cp .env.example .env
npm start
```

By default, `npm start` uses `proxy.conf.json` which proxies `/api` and `/media` to `http://127.0.0.1:8000`.

## Quality gates

```bash
npm run lint
npm run i18n:check
npm test -- --watch=false --browsers=ChromeHeadlessNoSandbox
npm run build
```

## E2E (Playwright)

```bash
E2E_BASE_URL=http://localhost:4201 npm run e2e
```

Stripe:
- Set `STRIPE_ENABLED=1` in `frontend/.env` to show Stripe as a payment option.
- Backend must have `STRIPE_ENV` and `STRIPE_SECRET_KEY_SANDBOX` / `STRIPE_SECRET_KEY_LIVE` (and webhook secret if used) configured.

Performance & bundle budget:
- Angular budgets are configured in `angular.json`; keep main bundle < 600 kB transfer. Use lazy loading for heavy routes and `ngOptimizedImage` + `loading=\"lazy\"` where possible.
- Prefer `npm run build --configuration production` for CI; this enables minification, output hashing, and ESBuild optimizations.
- Assets are compressed at the hosting layer; ensure gzip/brotli are enabled in your deploy target.
- Prefetch critical data via route resolvers (e.g., shop categories) to improve first meaningful paint.

Compression/caching guidance:
- Serve `dist/` with long-lived cache headers for JS/CSS (with hash) and shorter cache for HTML.
- Turn on brotli/gzip in your reverse proxy/CDN. Avoid shipping source maps to production.
