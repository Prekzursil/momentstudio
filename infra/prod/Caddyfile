{
	# Optional: set in infra/prod/.env (CADDY_EMAIL=...)
	email {$CADDY_EMAIL}
}

# Redirect www -> apex to keep a single canonical origin (payments + localStorage).
www.{$PUBLIC_DOMAIN} {
	redir https://{$PUBLIC_DOMAIN}{uri} permanent
}

# momentstudio.ro (production)
{$PUBLIC_DOMAIN} {
	encode zstd gzip

	@api path /api/*
	handle @api {
		reverse_proxy backend:8000
	}

	@media path /media/*
	handle @media {
		reverse_proxy backend:8000
	}

	# Everything else is served by the frontend (Angular build).
	handle {
		reverse_proxy frontend:80
	}
}
